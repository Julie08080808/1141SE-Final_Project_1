# --- [ schemas.py ] ---
# 📘 檔案用途：
# 這個檔案定義整個系統的「資料模型 (Schemas)」，
# 用來規範前後端交換的資料格式。
# Pydantic 會自動幫你驗證資料型態、檢查是否缺欄位。
# ✅ 主要模型包含：
#   1. UserCreate：使用者註冊
#   2. User：使用者資料（資料庫讀取）
#   3. ProjectCreate：建立專案
#   4. BidCreate：提交報價

from pydantic import BaseModel          # 👉 Pydantic 基礎模型，用來定義欄位格式與驗證
from typing import Optional             # 👉 讓欄位變成「可選填」
from datetime import date               # 👉 日期格式 (例如：截止日期)

# ----------------------------------------------------------
# 👤 1️⃣ 使用者註冊模型 (UserCreate)
# ----------------------------------------------------------
class UserCreate(BaseModel):
    """
    📄 用途：
        定義使用者在註冊帳號時所需輸入的欄位。
    ✅ 操作時機：
        當使用者在 /register.html 送出註冊表單，
        FastAPI 會使用這個模型驗證輸入資料格式。
    """
    name: str                           # 使用者名稱（必填）
    password: str                       # 使用者密碼（必填）
    user_type: str                      # 使用者身份：'client'（委託人）或 'contractor'（接案人）

# ----------------------------------------------------------
# 👥 2️⃣ 使用者資料模型 (User)
# ----------------------------------------------------------
class User(BaseModel):
    """
    📄 用途：
        用來從資料庫讀取使用者資料後回傳給前端。
    ✅ 操作時機：
        當你查詢使用者資料（例如登入驗證成功後），
        就會使用這個模型定義回傳內容。
    """
    uid: int                            # 使用者唯一編號（資料庫主鍵）
    name: str                           # 使用者名稱
    user_type: str                      # 使用者身分（'client' 或 'contractor'）

    class Config:
        orm_mode = True                 # 允許從 ORM（例如 SQLAlchemy）物件直接轉換成此模型

# ----------------------------------------------------------
# 📁 3️⃣ 專案建立模型 (ProjectCreate)
# ----------------------------------------------------------
class ProjectCreate(BaseModel):
    """
    📄 用途：
        委託人新增新專案時所需輸入的欄位。
    ✅ 操作時機：
        當使用者在前端表單送出「建立新專案」請求時，
        FastAPI 會根據這個模型驗證欄位格式。
    """
    title: str                          # 專案標題（必填）
    description: Optional[str] = None   # 專案描述（可選）
    budget: Optional[float] = None      # 預算金額（可選）
    deadline: Optional[date] = None     # 專案截止日期（可選，格式 YYYY-MM-DD）
    attachment_url: Optional[str] = None# 附件或上傳檔案的網址（可選）

# ----------------------------------------------------------
# 💰 4️⃣ 報價建立模型 (BidCreate)
# ----------------------------------------------------------
class BidCreate(BaseModel):
    """
    📄 用途：
        接案人針對專案提交報價時所需的欄位。
    ✅ 操作時機：
        當接案人從前端填寫「報價金額」並送出時，
        FastAPI 會依此模型檢查格式是否正確。
    """
    price: float                        # 報價金額（必填）
    message: Optional[str] = None        # 備註訊息（可選，例如補充說明或留言）

# ----------------------------------------------------------
# 📘 整體功能總結
# ----------------------------------------------------------
"""
這個 schemas.py 的功能可以簡單理解成「資料交換格式規範書」。
它負責定義所有與資料有關的欄位、型別與驗證規則，
讓 FastAPI 自動處理「資料格式驗證」與「輸出轉換」。

🔧 操作流程：
1️⃣ 前端送出表單 → FastAPI 自動對照這裡的模型檢查資料格式。
2️⃣ 後端 CRUD 操作完成 → 回傳符合模型的資料結構給前端。
3️⃣ 若欄位缺少或型別錯誤 → FastAPI 會自動回傳錯誤訊息。

📦 主要模型用途總覽：
| 模型名稱        | 使用時機             | 功能說明 |
|------------------|--------------------|-----------|
| UserCreate       | 使用者註冊時        | 驗證註冊帳號、密碼、角色資料 |
| User             | 從資料庫讀取使用者時 | 格式化回傳的使用者資料 |
| ProjectCreate    | 委託人建立新專案時   | 驗證專案標題、描述、預算、截止日期 |
| BidCreate        | 接案人提交報價時     | 驗證報價金額與留言內容 |

✅ 總結一句話：
schemas.py 是 FastAPI 專案中用來「規範資料格式、驗證輸入輸出」的重要檔案，
確保所有資料在進入系統前後都符合正確結構。
"""
